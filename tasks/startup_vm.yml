---
- name: starting up {{ vm_name }}
  virt:
    name: "{{ vm_name }}"
    state: running

- block:
    - name: check if VM is reachable on known ip address
      command: ping -c1 {{ vm_ip }}
      register: ping_result
      ignore_errors: yes

    - fail:
        msg: VM is unreachable
      when: ping_result is failed
  rescue:
    - debug:
        msg: "could not get ip for a vm"
